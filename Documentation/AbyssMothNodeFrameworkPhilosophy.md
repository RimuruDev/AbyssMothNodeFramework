# AbyssMoth Node Framework Philosophy (RU)

- Актуально для ветки пакета: `v3.x` (текущая сборка `3.0.0`)

## Цель

Фреймворк решает практичную задачу: дать инди-команде быстрый и предсказуемый пайплайн разработки на Unity, где:
- архитектура читается визуально в иерархии,
- жизненный цикл фич контролируется явно,
- можно быстро запускать и поддерживать проект без сложной инфраструктуры.

## Базовая идея

Вместо «все в MonoBehaviour callbacks» используется иерархия:

`SceneConnector -> LocalConnector -> ConnectorNode`

- `SceneConnector` управляет всей сценой.
- `LocalConnector` = отдельная фича (герой, NPC, UI-блок, дверь и т.д.).
- `ConnectorNode` = шаги логики фичи (bind/init/tick/dispose).

Это дает:
- локальный контроль (пауза/резюм/уничтожение фичи),
- сценовый контроль (пауза всей сцены),
- предсказуемый lifecycle.

## Контекст и DI

Два контейнера:
- `ProjectContext` (`ProjectRootConnector`) — глобальные сервисы между сценами.
- `SceneContext` (`SceneConnector`) — сервисы текущей сцены.

`SceneContext` наследуется от `ProjectContext`, поэтому сцена может получать глобальные сервисы через `Get<T>()`.

## ECS-нотка без жесткой ECS

`SceneEntityIndex` дает быстрые выборки:
- по `Id`,
- по `Tag`,
- по типу `LocalConnector`,
- по типу нод.

`LocalConnector` выступает как «сущность фичи», ноды — как ее компонентные шаги логики.

## Что важно в текущей версии

- `EntityId` назначается автоматически.
- Основная адресация в геймплее обычно через `EntityTag` и типы.
- Есть instant registration при spawn (`InstantiateAndRegister`), без ожидания 1 кадра.

## Рекомендованный стиль работы

1. На сцене один `SceneConnector`.
2. Каждая фича — отдельный `LocalConnector`.
3. Логику дробить на `ConnectorNode`.
4. Поиск сущностей делать через `SceneEntityIndex`.
5. Для runtime спавна использовать только API регистрации фреймворка.

## Почему это удобно для маленькой команды

- Арт-директор/тех-художник видит структуру фич прямо в иерархии.
- Программист работает в стабильном lifecycle и DI-контексте.
- Меньше «магии», больше явных точек контроля и диагностики.
